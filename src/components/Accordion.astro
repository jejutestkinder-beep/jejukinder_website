---
export interface AccordionItem {
  question: string;
  answer: string;
}

interface Props {
  items: AccordionItem[];
}

const { items } = Astro.props;
---

<div class="w-full max-w-4xl mx-auto px-6 py-8">
  {items.map((item, index) => (
    <div class="border-b border-gray-200 accordion-item" data-index={index}>
      <button
        class="w-full flex items-center justify-between py-4 px-0 text-left accordion-button"
        aria-expanded={index === 0 ? 'true' : 'false'}
        aria-controls={`accordion-content-${index}`}
      >
        <span class="text-lg font-semibold text-gray-800 pr-4">{item.question}</span>
        <span class="flex-shrink-0 text-gray-500 accordion-icon transition-transform duration-300">▼</span>
      </button>
      <div
        id={`accordion-content-${index}`}
        class="overflow-hidden accordion-content transition-all duration-300"
        aria-hidden={index === 0 ? 'false' : 'true'}
      >
        <div class="pb-4 text-gray-600 leading-relaxed" set:html={item.answer} />
      </div>
    </div>
  ))}
</div>

<script>
  document.querySelectorAll('.accordion-button').forEach((button, index) => {
    const content = button.nextElementSibling as HTMLElement;
    const icon = button.querySelector('.accordion-icon') as HTMLElement;
    const item = button.closest('.accordion-item') as HTMLElement;
    
    // 첫 번째 항목은 기본적으로 열림
    if (index === 0) {
      content.style.maxHeight = content.scrollHeight + 'px';
      button.setAttribute('aria-expanded', 'true');
      content.setAttribute('aria-hidden', 'false');
      icon.style.transform = 'rotate(180deg)';
    } else {
      content.style.maxHeight = '0px';
      button.setAttribute('aria-expanded', 'false');
      content.setAttribute('aria-hidden', 'true');
    }

    button.addEventListener('click', () => {
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      
      if (isExpanded) {
        // 닫기
        content.style.maxHeight = '0px';
        button.setAttribute('aria-expanded', 'false');
        content.setAttribute('aria-hidden', 'true');
        icon.style.transform = 'rotate(0deg)';
      } else {
        // 열기
        content.style.maxHeight = content.scrollHeight + 'px';
        button.setAttribute('aria-expanded', 'true');
        content.setAttribute('aria-hidden', 'false');
        icon.style.transform = 'rotate(180deg)';
      }
    });
  });
</script>

<style>
  .accordion-content {
    max-height: 0;
  }
</style>

