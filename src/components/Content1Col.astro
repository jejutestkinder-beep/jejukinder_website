---
import { colors } from '../utils/colors';

type ColorName = 'brown' | 'bgPink' | 'lightPink' | 'lightYellow' | 'grey' | 'darkGrey' | 'rose' | 'green' | 'white' | 'black' | string;

interface Props {
  title?: string;
  description?: string;
  titleColor?: ColorName;
  textColor?: ColorName;
  bgColor?: ColorName;
  titleTag?: 'h2' | 'h3';
  class?: string;
  noBottomPadding?: boolean;
}

const {
  title,
  description,
  titleColor,
  textColor,
  bgColor = 'grey',
  titleTag = 'h3',
  class: className = '',
  noBottomPadding = false
} = Astro.props;

const TitleTag = titleTag;

const getBgClass = (color: ColorName): string => {
  const colorMap: Record<string, string> = {
    white: 'bg-white',
    black: 'bg-black',
    brown: 'bg-custom-brown',
    grey: 'bg-custom-grey',
    rose: 'bg-custom-rose',
    green: 'bg-custom-green',
    bgPink: 'bg-custom-bg-pink',
    lightPink: 'bg-custom-light-pink',
    lightYellow: 'bg-custom-light-yellow',
  };
  
  return colorMap[color] || '';
};

const getBgStyle = (color: ColorName): string => {
  // If it's a predefined color name from our palette, use the color value
  if (colors[color as keyof typeof colors]) {
    return `background-color: ${colors[color as keyof typeof colors]};`;
  }
  // If it's a custom color code, use inline style
  return `background-color: ${color};`;
};

const bgClass = getBgClass(bgColor);
const bgStyle = getBgStyle(bgColor);

const getTextColorStyle = (color?: ColorName): string => {
  if (!color) return '';
  if (colors[color as keyof typeof colors]) {
    return `color: ${colors[color as keyof typeof colors]} !important;`;
  }
  return `color: ${color} !important;`;
};

const titleColorStyle = getTextColorStyle(titleColor);
const textColorStyle = getTextColorStyle(textColor);
const paddingClass = noBottomPadding 
  ? 'pt-24 md:pt-28 pb-24 md:pb-28 -mb-4 md:-mb-5 lg:-mb-6 xl:-mb-8' 
  : 'py-24 md:py-28';
---

<section class={`${paddingClass} ${bgClass} w-[calc(100%+48px)] -mx-6 ${className}`} style={bgStyle}>
  <div class="max-w-4xl mx-auto px-6 md:px-4 text-center">
    {title && (
      <TitleTag style={titleColorStyle} set:html={title} />
    )}
    {description && (
      <h6 style={textColorStyle} set:html={description} />
    )}
    <slot />
  </div>
</section>

